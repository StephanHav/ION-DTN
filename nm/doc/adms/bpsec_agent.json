{
  "adm:constants": [
    {
      "name": "name",
      "type": "STR",
      "value": "bpsec",
      "description": "The human-readable name of the ADM."
    },
    {
      "name": "namespace",
      "type": "STR",
      "value": "arn:DTN:bpsec",
      "description": "The namespace of the ADM."
    },
    {
      "name": "version",
      "type": "STR",
      "value": "2016_05_16",
      "description": "The version of the ADM."
    },
    {
      "name": "organization",
      "type": "STR",
      "value": "JHUAPL",
      "description": "The name of the issuing organization of the ADM."
    }
  ],
  "adm:externally-defined-data": [
    {
      "name": "num_good_tx_bcb_blk",
      "type": "UINT",
      "description": "Total successfully Tx BCB blocks"
    },
    {
      "name": "num_bad_tx_bcb_blk",
      "type": "UINT",
      "description": "Total unsuccessfully Tx BCB blocks"
    },
    {
      "name": "num_good_rx_bcb_blk",
      "type": "UINT",
      "description": "Total successfully Rx BCB blocks"
    },
    {
      "name": "num_bad_rx_bcb_blk",
      "type": "UINT",
      "description": "Total unsuccessfully Rx BCB blocks"
    },
    {
      "name": "num_missing_rx_bcb_blks",
      "type": "UINT",
      "description": "Total missing-on-RX BCB blocks"
    },
    {
      "name": "num_fwd_bcb_blks",
      "type": "UINT",
      "description": "Total forward BCB blocks"
    },
    {
      "name": "num_good_tx_bcb_bytes",
      "type": "UINT",
      "description": "Total successfully Tx bcb bytes"
    },
    {
      "name": "num_bad_tx_bcb_bytes",
      "type": "UINT",
      "description": "Total unsuccessfully Tx bcb bytes"
    },
    {
      "name": "num_good_rx_bcb_bytes",
      "type": "UINT",
      "description": "Total successfully Rx bcb bytes"
    },
    {
      "name": "num_bad_rx_bcb_bytes",
      "type": "UINT",
      "description": "Total unsuccessfully Rx bcb bytes"
    },
    {
      "name": "num_missing_rx_bcb_bytes",
      "type": "UINT",
      "description": "Total missing-on-Rx bcb bytes"
    },
    {
      "name": "num_fwd_bcb_bytes",
      "type": "UINT",
      "description": "Total forwarded bcb bytes"
    },
    {
      "name": "num_good_tx_bib_blks",
      "type": "UINT",
      "description": "Total successfully Tx BIB blocks"
    },
    {
      "name": "num_bad_tx_bib_blks",
      "type": "UINT",
      "description": "Total unsuccessfully Tx BIB blocks"
    },
    {
      "name": "num_good_rx_bib_blks",
      "type": "UINT",
      "description": "Total successfully Rx BIB blocks"
    },
    {
      "name": "num_bad_rx_bib_blks",
      "type": "UINT",
      "description": "Total unsuccessfully Rx BIB blocks"
    },
    {
      "name": "num_miss_rx_bib_blks",
      "type": "UINT",
      "description": "Total missing-on-Rx BIB blocks"
    },
    {
      "name": "num_fwd_bib_blks",
      "type": "UINT",
      "description": "Total forwarded BIB blocks"
    },
    {
      "name": "num_good_tx_bib_bytes",
      "type": "UINT",
      "description": "Total successfully Tx BIB bytes"
    },
    {
      "name": "num_bad_tx_bib_bytes",
      "type": "UINT",
      "description": "Total unsuccessfully Tx BIB bytes"
    },
    {
      "name": "num_good_rx_bib_bytes",
      "type": "UINT",
      "description": "Total successfully Rx BIB bytes"
    },
    {
      "name": "num_bad_rx_bib_bytes",
      "type": "UINT",
      "description": "Total unsuccessfully Rx BIB bytes"
    },
    {
      "name": "num_miss_rx_bib_bytes",
      "type": "UINT",
      "description": "Total missing-on-Rx BIB bytes"
    },
    {
      "name": "num_fwd_bib_bytes",
      "type": "UINT",
      "description": "Total forwarded BIB bytes"
    },
    {
      "name": "last_update",
      "type": "TS",
      "description": "Last BPSEC update"
    },
    {
      "name": "num_known_keys",
      "type": "UINT",
      "description": "Number of known keys"
    },
    {
      "name": "key_names",
      "type": "STR",
      "description": "Known key names"
    },
    {
      "name": "ciphersuite_names",
      "type": "STR",
      "description": "Known ciphersuite names"
    },
    {
      "name": "rule_source",
      "type": "STR",
      "description": "Known rule sources"
    },
    {
      "name": "num_good_tx_bcb_blks_src",
      "type": "UINT",
      "parmspec": [{"STR":"Src"}],
      "description": "Successfully Tx BCB blocks from SRC"
    },
    {
      "name": "num_bad_tx_bcb_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed TX BCB blocks from SRC"
    },
    {
      "name": "num_good_rx_bcb_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Rx BCB blocks from SRC"
    },
    {
      "name": "num_bad_rx_bcb_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed RX BCB blocks from SRC"
    },
    {
      "name": "num_missing_rx_bcb_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Missing-onRX BCB blocks from SRC"
    },
    {
      "name": "num_fwd_bcb_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Forwarded BCB blocks from SRC"
    },
    {
      "name": "num_good_tx_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfullt Tx bcb bytes from SRC"
    },
    {
      "name": "num_bad_tx_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Tx bcb bytes from SRC"
    },
    {
      "name": "num_good_rx_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Rx bcb bytes from SRC"
    },
    {
      "name": "num_bad_rx_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Rx bcb bytes from SRC"
    },
    {
      "name": "num_missing_rx_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Missin-on-Rx bcb bytes from SRC"
    },
    {
      "name": "num_fwd_bcb_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Forwarded bcb bytes from SRC"
    },
    {
      "name": "num_good_tx_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Tx BIB blocks from SRC"
    },
    {
      "name": "num_bad_tx_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Tx BIB blocks from SRC"
    },
    {
      "name": "num_good_rx_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Rx BIB blocks from SRC"
    },
    {
      "name": "num_bad_rx_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Rx BIB blocks from SRC"
    },
    {
      "name": "num_miss_rx_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Missing-on-Rx BIB blocks from SRC"
    },
    {
      "name": "num_fwd_bib_blks_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Forwarded BIB blocks from SRC"
    },
    {
      "name": "num_good_tx_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Tx BIB bytes from SRC"
    },
    {
      "name": "num_bad_tx_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Tx BIB bytes from SRC"
    },
    {
      "name": "num_good_rx_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Successfully Rx BIB bytes from SRC"
    },
    {
      "name": "num_bad_rx_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Failed Rx BIB bytes from SRC"
    },
    {
      "name": "num_missing_rx_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Missing-on-Rx BIB bytes from SRC"
    },
    {
      "name": "num_fwd_bib_bytes_src",
      "parmspec": [{"STR":"Src"}],
      "type": "UINT",
      "description": "Forwarded BIB bytes from SRC"
    },
    {
      "name": "last_update_src",
      "parmspec": [{"STR":"Src"}],
      "type": "TS",
      "description": "Last BPSEC Update from SRC"
    },
    {
      "name": "last_reset",
      "parmspec": [{"STR":"Src"}],
      "type": "TS",
      "description": "Last reset"
    }
  ],
  "adm:tables" : [
    {
      "name": "keys",
      "columns": [{"STR":"key_name"}],
      "description": "This table lists all keys in the security policy database."
    },
    {
      "name": "ciphersuites",
      "columns": [{"STR":"csname"}],
      "description": "This table lists supported ciphersuites."
    },    
    {
      "name": "bib_rules",
      "columns": [{"STR":"SrcEid"}, 
                  {"STR":"DestEid"},
                  {"UINT":"TgtBlk"},
                  {"STR":"csName"},
                  {"STR":"keyName"}
                ],
      "description": "BIB Rules."
    },
    {
      "name": "bcb_rules",
      "columns": [{"STR":"SrcEid"}, 
                  {"STR":"DestEid"},
                  {"UINT":"TgtBlk"},
                  {"STR":"csName"},
                  {"STR":"keyName"}
                ],
      "description": "BCB Rules."
    }
  ],
 "adm:variables": [
    {
      "name": "total_bad_tx_blks",
      "type": "UINT",
      "initializer": {
        "type": "UINT",
        "postfix-expr": ["EDD.num_bad_tx_bib_blks_src","EDD.num_bad_tx_bcb_blks_src"]
      },
      "description": "This is the number of failed TX blocks (# failed BIB + # failed bcb)."
    }
  ],
  "adm:report-templates": [
    {
      "name": "full_report",
      "parmspec": [{"STR":"Source"}],
      "definition" : [
        "EDD.num_good_tx_bcb_blk",
        "EDD.num_bad_tx_bcb_blk",
        "EDD.num_good_rx_bcb_blk",
        "EDD.num_bad_rx_bcb_blk",
        "EDD.num_missing_rx_bcb_blks",
        "EDD.num_fwd_bcb_blks",
        "EDD.num_good_tx_bcb_bytes",
        "EDD.num_bad_tx_bcb_bytes",
        "EDD.num_good_rx_bcb_bytes",
        "EDD.num_bad_rx_bcb_bytes",
        "EDD.num_missing_rx_bcb_bytes",
        "EDD.num_fwd_bcb_bytes",
        "EDD.num_good_tx_bib_blks",
        "EDD.num_bad_tx_bib_blks",
        "EDD.num_good_rx_bib_blks",
        "EDD.num_bad_rx_bib_blks",  
        "EDD.num_miss_rx_bib_blks",      
        "EDD.num_fwd_bib_blks",
        "EDD.num_good_tx_bib_bytes",
        "EDD.num_bad_tx_bib_bytes",
        "EDD.num_good_rx_bib_bytes",
        "EDD.num_bad_rx_bib_bytes",
        "EDD.num_miss_rx_bib_bytes",
        "EDD.num_fwd_bib_bytes",
        "EDD.last_update",
        "EDD.num_known_keys",
        "EDD.key_names",
        "EDD.ciphersuite_names",
        "EDD.rule_source"
      ],
      "description": "all known meta-data, externally defined data, and variables"
    },
    {
      "name": "source_report",
      "parmspec": [{"STR":"Source"}],
      "definition": [
        "EDD.num_good_tx_bcb_blks_src",
        "EDD.num_bad_tx_bcb_blks_src",
        "EDD.num_good_rx_bcb_blks_src",
        "EDD.num_bad_rx_bcb_blks_src",
        "EDD.num_missing_rx_bcb_blks_src",
        "EDD.num_fwd_bcb_blks_src",
        "EDD.num_good_tx_bcb_bytes_src",
        "EDD.num_bad_tx_bcb_bytes_src",
        "EDD.num_good_rx_bcb_bytes_src",
        "EDD.num_bad_rx_bcb_bytes_src",
        "EDD.num_missing_rx_bcb_bytes_src",
        "EDD.num_fwd_bcb_bytes_src",
        "EDD.num_good_tx_bib_blks_src",
        "EDD.num_bad_tx_bib_blks_src",
        "EDD.num_good_rx_bib_blks_src",
        "EDD.num_bad_rx_bib_blks_src",
        "EDD.num_miss_rx_bib_blks_src",
        "EDD.num_fwd_bib_blks_src",
        "EDD.num_good_tx_bib_bytes_src",
        "EDD.num_bad_tx_bib_bytes_src",
        "EDD.num_good_rx_bib_bytes_src",
        "EDD.num_bad_rx_bib_bytes_src",
        "EDD.num_missing_rx_bib_bytes_src",
        "EDD.num_fwd_bib_bytes_src",
        "EDD.last_update_src",
        "EDD.last_reset"        
      ],
      "description": "security info by source"
    }
  ],
  "adm:controls": [
  {
      "name": "rst_all_cnts",
      "description": "This control causes the Agent to reset all counts associated with block or byte statistics and to set the Last Reset Time of the BPsec EDD data to the time when the control was run."
    },
    {
      "name": "rst_src_cnts",
      "parmspec": [{"STR":"src"}],
      "description": "This control causes the Agent to reset all counts (blocks and bytes) associated with a given bundle source and set the Last Reset Time of the source statistics to the time when the control was run."
    },
    {
      "name": "delete_key",
      "parmspec": [{"STR":"key_name"}],
      "description": "This control deletes a key from the BPsec system."
    },
    {
      "name": "add_key",
      "parmspec": [{"STR":"key_name"},{"BLOB":"keyData"}],
      "description": "This control adds a key to the BPsec system."
    },
    {
      "name": "add_bib_rule",
      "parmspec": [{"STR":"source"},{"STR":"destination"},{"INT":"target"},{"STR":"ciphersuiteId"},{"STR":"key_name"}],
      "description": "This control configures policy on the BPsec protocol implementation that describes how BIB blocks should be applied to bundles in the system. This policy is captured as a rule which states when transmitting a bundle from the given source endpoint ID to the given destination endpoint ID, blocks of type target should have a BIB added to them using the given ciphersuite and the given key."
    },
    {
      "name": "del_bib_rule",
      "parmspec": [{"STR":"source"},{"STR":"destination"},{"INT":"target"}],
      "description": "This control removes any configured policy on the BPsec protocol implementation that describes how BIB blocks should be applied to bundles in the system. A BIB policy is uniquely identified by a source endpoint Id, a destination Id, and a target block type."
    },
    {
      "name": "list_bib_rules",
      "description": "This control returns a table describinng all of the BIB policy rules that are known to the BPsec implementation."
    },
    {
      "name": "add_bcb_rule",
      "parmspec": [{"STR":"source"},{"STR":"destination"},{"INT":"target"},{"STR":"ciphersuiteId"},{"STR":"key_name"}],
      "description": "This control configures policy on the BPsec protocol implementation that describes how BCB blocks should be applied to bundles in the system. This policy is captured as a rule which states when transmitting a bundle from the given source endpoint id to the given destination endpoint id, blocks of type target should have a bcb added to them using the given ciphersuite and the given key."
    },
    {
      "name": "del_bcb_rule",
      "parmspec": [{"STR":"source"},{"STR":"destination"},{"INT":"target"}],
      "description": "This control removes any configured policy on the BPsec protocol implementation that describes how BCB blocks should be applied to bundles in the system. A bcb policy is uniquely identified by a source endpoint id, a destination endpoint id, and a target block type."
    },
    {
      "name": "list_bcb_rules",
      "description": "This control returns a table describing all of the bcb policy rules that are known to the BPsec implementation"
    }
  ],
  "adm:macros": [
    
  ],
  "adm:operators": [
  ]
}
